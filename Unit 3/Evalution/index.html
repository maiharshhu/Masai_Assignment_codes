<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Realtime Product Dashboard!</title>

    <style>
      * {
        margin: 0px;
        padding: 0px;
        box-sizing: border-box;
      }

      body {
        font-family: sans-serif;
        background-color: #f5f5f5;
        line-height: 1.4;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        line-height: 1.6;
      }

      .header {
        text-align: center;
        margin-bottom: 40px;
        border: 2px solid palevioletred;
      }

      .header h1 {
        color: #666;
        font-size: 2.5rem;
        margin-bottom: 10px;
      }

      .header p {
        font-size: 1.1rem;
        color: #666;
      }

      .product-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 25px;
      }

      .product-card {
        background: white;
        border-radius: 12px;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <h1>Products list</h1>
    <div class="container">
      <div class="header">
        <h1>Product Catalog</h1>
        <p>Discover Products</p>
      </div>

      <div id="LoadingIndicator" class="Loading">LoadingProducts...</div>
      <div id="ProductsContainer" class="products-grid"></div>
    </div>

    <script>
            let allProducts = [];

            let LoadingIndicator = document.getElementById("loadingIndicator");
            let productsContainer = document.getElementById("ProductsContainer");

            async function fetchData() {
              try {
                showLoading(true);
                const response = await fetch("https://dummyjson.com/products");

                if (!response.ok) {
                  throw new Error("HTTP Error! status:${response.status}");
                }
                const data = await response.json();
                allProducts = data;

                console.log("Successfully fetched ${allProducts.length} Products");
                return allProducts;
              } catch (error) {
                console.error("Error Fetching Products:", error);

                allProducts = generateMockProducts();
                console.log("Using ${allProducts.length} mock products as fallback");
                return allProducts;
              }
            }

            function generateMockProducts() {
              const Categories = [
                "electronics",
                "clothing",
                "books",
                "home",
                "sports",
              ];
              const productNames = [
                "Wireless Bluetooth Headphones",
                "Smartphone Tripod Stand",
                "Gaming Mechanical Keyboard",
                "Stainless Steel Water Bottle",
                "LED Strip Lights",
                "Portable Power Bank 10000mAh",
                "Cotton Crew Neck T-Shirt",
                "Noise Cancelling Earbuds",
                "Laptop Sleeve 15.6 inch",
                "Rechargeable Electric Toothbrush",
                "Organic Green Tea Bags",
                "Adjustable Office Chair",
                "Ceramic Non-Stick Frying Pan",
                "Foldable Yoga Mat",
                "Digital Kitchen Scale",
                "Wireless Mouse",
                "Smart Fitness Band",
                "Scented Soy Candles Set",
                "Multifunctional Screwdriver Kit",
                "4K Action Camera",
              ];

              const mockProducts = [];

              for (let i = 0; i < 20; i++) {
                mockProducts.push({
                  id: i + 1,
                  title: productNames[i] || `Product ${i + 1}`,
                  description: `About this Product:${
                    productNames[i] || `Product ${i + 1}`
                  }. good product`,
                  price: Math.floor(Math.random() * 500) + 10,
                  category: Math.floor[Math.random() * Categories.length],
                  image: "https://picsum.photos/200/300?random=${i+1}",
                });
              }

              return mockProducts;
            }

            function createProductCard(product) {
              const card = document.createElement("div");
              card.className = "product-card";
              card.setAttribute("data-prodect-id", product.id);

              card.innerHTML = `
              <img src="${product.image}"
              alt="${product.title}"
              class="product-image"
              onerror = "handleImageError(this, ${product.id})">

              <div id="product-content">
                  <div class="product-category">${product.category}</div>
                  <div class="product-title">${product.title}</div>
                  <div class="product-description">${product.description}</div>
                  <div class="product-footer">
                      <span class="product-price">$${product.price}</span>
                      <button class="add-to-cart" onclick="addToCart(${product.id})">Add to Cart</button>
                      </div>
              </div>
              `;
              return card;
            }

            function randerProducts(products) {
              console.log(`Rendering ${products.length} products to the page`);

              productsContainer.innerHTML = "";

              if (products.length === 0) {
                productsContainer.innerHTML = `<div class="error-message">
                      No Products to display.
                      </div>
                      `;
                return;
              }

              products.forEach((product, index) => {
                const card = createProductCard(product);
                productsContainer.append(card);
              });

              card.style.opacity = '0';
              card.style.tranform = "translateY(0)";
            }, index*50)
          });
      }
    </script>
  </body>
</html>
