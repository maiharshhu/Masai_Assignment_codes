<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Realtime Product Dashboard!</title>

    <style>
      * {
        margin: 0px;
        padding: 0px;
        box-sizing: border-box;
      }

      body {
        font-family: sans-serif;
        background-color: #f5f5f5;
        line-height: 1.4;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        line-height: 1.6;
      }

      .header {
        text-align: center;
        margin-bottom: 40px;
        border: 2px solid palevioletred;
      }

      .header h1 {
        color: #666;
        font-size: 2.5rem;
        margin-bottom: 10px;
      }

      .header p {
        font-size: 1.1rem;
        color: #666;
      }

      .product-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 25px;
      }

      .product-card {
        background: white;
        border-radius: 12px;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <h1>Products list</h1>
    <div class="container">
      <div class="header">
        <h1>Product Catalog</h1>
        <p>Discover Products</p>
      </div>

      <div id="LoadingIndicator" class="Loading">LoadingProducts...</div>
      <div id="ProductsContainer" class="products-grid"></div>
    </div>

    <script>
      // Global variables
      let allProducts = [];

      // DOM elements
      const loadingIndicator = document.getElementById("loadingIndicator");
      const productsContainer = document.getElementById("productsContainer");

      // 1. FETCH PRODUCTS FROM API
      async function fetchProducts() {
        try {
          console.log("üîÑ Fetching products from API...");
          showLoading(true);

          const response = await fetch("https://dummyjson.com/products");

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();
          allProducts = data;

          console.log(`‚úÖ Successfully fetched ${allProducts.length} products`);
          return allProducts;
        } catch (error) {
          console.error("‚ùå Error fetching products:", error);

          // Use mock data as fallback
          allProducts = generateMockProducts();
          console.log(
            `üì¶ Using ${allProducts.length} mock products as fallback`
          );
          return allProducts;
        }
      }

      // 2. GENERATE MOCK PRODUCTS (fallback)
      function generateMockProducts() {
        const categories = [
          "electronics",
          "clothing",
          "books",
          "home",
          "sports",
        ];
        const productNames = [
          "Wireless Headphones",
          "Cotton T-Shirt",
          "JavaScript Book",
          "Coffee Mug",
          "Running Shoes",
          "Smartphone",
          "Denim Jeans",
          "Python Guide",
          "Table Lamp",
          "Yoga Mat",
          "Laptop Bag",
          "Summer Dress",
          "HTML Manual",
          "Wall Clock",
          "Basketball",
          "Bluetooth Speaker",
          "Hoodie",
          "CSS Tricks",
          "Picture Frame",
          "Tennis Racket",
        ];

        const mockProducts = [];

        for (let i = 0; i < 20; i++) {
          mockProducts.push({
            id: i + 1,
            title: productNames[i] || `Product ${i + 1}`,
            description: `This is a high-quality ${
              productNames[i] || `product ${i + 1}`
            }. Perfect for everyday use with excellent features and great value for money. Highly recommended by customers.`,
            price: Math.floor(Math.random() * 500) + 10,
            category: categories[Math.floor(Math.random() * categories.length)],
            image: `https://picsum.photos/300/200?random=${i + 1}`,
          });
        }

        return mockProducts;
      }

      // 3. CREATE PRODUCT CARD HTML
      function createProductCard(product) {
        const card = document.createElement("div");
        card.className = "product-card";
        card.setAttribute("data-product-id", product.id);

        card.innerHTML = `
                <img src="${product.image}" 
                     alt="${product.title}" 
                     class="product-image" 
                     onerror="handleImageError(this, ${product.id})">
                <div class="product-content">
                    <div class="product-category">${product.category}</div>
                    <h3 class="product-title">${product.title}</h3>
                    <p class="product-description">${product.description}</p>
                    <div class="product-footer">
                        <span class="product-price">$${product.price}</span>
                        <button class="add-to-cart" onclick="addToCart(${product.id})">
                            Add to Cart
                        </button>
                    </div>
                </div>
            `;

        return card;
      }

      // 4. RENDER PRODUCTS TO DOM
      function renderProducts(products) {
        console.log(`üé® Rendering ${products.length} products to the page`);

        // Clear the container
        productsContainer.innerHTML = "";

        // Check if there are products to display
        if (products.length === 0) {
          productsContainer.innerHTML = `
                    <div class="error-message">
                        No products available to display.
                    </div>
                `;
          return;
        }

        // Create and append product cards
        products.forEach((product, index) => {
          const card = createProductCard(product);
          productsContainer.appendChild(card);

          // Add a small delay for smooth loading animation
          card.style.opacity = "0";
          card.style.transform = "translateY(20px)";

          setTimeout(() => {
            card.style.transition = "opacity 0.3s ease, transform 0.3s ease";
            card.style.opacity = "1";
            card.style.transform = "translateY(0)";
          }, index * 50); // Stagger the animations
        });
      }

      // 5. SHOW/HIDE LOADING INDICATOR
      function showLoading(isLoading) {
        if (isLoading) {
          loadingIndicator.style.display = "block";
          productsContainer.style.display = "none";
        } else {
          loadingIndicator.style.display = "none";
          productsContainer.style.display = "grid";
        }
      }

      // 6. HANDLE IMAGE LOADING ERRORS
      function handleImageError(img, productId) {
        console.log(
          `‚ö†Ô∏è Image failed to load for product ${productId}, using fallback`
        );
        img.src = `https://picsum.photos/300/200?random=${productId}`;
      }

      // 7. ADD TO CART FUNCTIONALITY (placeholder)
      function addToCart(productId) {
        const product = allProducts.find((p) => p.id === productId);

        if (product) {
          console.log(`üõí Adding product to cart:`, product.title);
          alert(`"${product.title}" has been added to your cart!`);
        } else {
          console.error("‚ùå Product not found");
        }
      }

      // 8. INITIALIZE THE APPLICATION
      async function initializeApp() {
        console.log("üöÄ Initializing Product Catalog...");

        try {
          // Fetch products
          await fetchProducts();

          // Render products
          renderProducts(allProducts);

          // Hide loading
          showLoading(false);

          console.log("‚úÖ Application initialized successfully!");
        } catch (error) {
          console.error("‚ùå Failed to initialize application:", error);
          showLoading(false);
          productsContainer.innerHTML = `
                    <div class="error-message">
                        Sorry, there was an error loading the products. Please try again later.
                    </div>
                `;
        }
      }

      // 9. START THE APPLICATION WHEN PAGE LOADS
      document.addEventListener("DOMContentLoaded", () => {
        console.log("üìÑ DOM loaded, starting application...");
        initializeApp();
      });
    </script>
  </body>
</html>
